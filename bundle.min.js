var np={config:{appContainer:"#notepad"},fontFamily:"Arial",fontStype:"常规",fontSize:"16",fontHandler:function(t){np.fontFamily=t.family,np.fontStype=t.style,np.fontSize=t.size,$editor.setFont(t)}};$(function(){$menubar.show(np.menuData),$editor.show({posHandler:function(t,n){},contentHandler:function(t){$menubar.enabled(1,6,t)}}),$editor.setFont({family:np.fontFamily,style:np.fontStype,size:np.fontSize}),$("body").click(function(){$menubar.hideMenu()})}),np.menuData=[{title:"文件(F)",menuItems:[{title:"新建(N)",shortcut:"Ctrl+N",enabled:!0,handler:function(){window.console.log("新建(N) menu clicked!")}},{title:"打开(O)...",shortcut:"Ctrl+O",enabled:!0,handler:function(){window.console.log("打开(O) menu clicked!")}},{title:"保存(S)",shortcut:"Ctrl+S",enabled:!0,handler:function(){window.console.log("保存(S) menu clicked!")}},{title:"另存为(A)...",shortcut:"",enabled:!0,handler:function(){window.console.log("另存为(A) menu clicked!")}},{title:"hr",shortcut:"",enabled:!0,handler:null},{title:"页面设置(U)...",shortcut:"",enabled:!0,handler:function(){window.console.log("页面设置(U) menu clicked!")}},{title:"打印(P)...",shortcut:"Ctrl+P",enabled:!0,handler:function(){window.console.log("打印(P) menu clicked!")}},{title:"hr",shortcut:"",enabled:!0,handler:null},{title:"退出(X)",shortcut:"",enabled:!0,handler:function(){window.console.log("退出(X) menu clicked!")}}],width:"202px",left:"0px"},{title:"编辑(E)",menuItems:[{title:"撤销(U)",shortcut:"Ctrl+Z",enabled:!1,handler:function(){window.console.log("撤销(U) menu clicked!")}},{title:"hr",shortcut:"",enabled:!0,handler:null},{title:"剪切(T)",shortcut:"Ctrl+X",enabled:!0,handler:function(){window.console.log("剪切(X) menu clicked!")}},{title:"复制(C)",shortcut:"Ctrl+C",enabled:!1,handler:function(){window.console.log("复制(C) menu clicked!")}},{title:"粘贴(P)",shortcut:"Ctrl+V",enabled:!1,handler:function(){window.console.log("粘贴(P) menu clicked!")}},{title:"删除(L)",shortcut:"Del",enabled:!1,handler:function(){window.console.log("删除(L) menu clicked!")}},{title:"hr",shortcut:"",enabled:!0,handler:null},{title:"使用 Bing 搜索...",shortcut:"Ctrl+E",enabled:!0,handler:function(){window.console.log("Bing搜索被 clicked!")}},{title:"查找(F)...",shortcut:"Ctrl+F",enabled:!1,handler:function(){window.console.log("查找(F) menu clicked!")}},{title:"查找下一个(N)",shortcut:"F3",enabled:!1,handler:function(){window.console.log("查找下一个(N) menu clicked!")}},{title:"替换(R)...",shortcut:"Ctrl+H",enabled:!0,handler:function(){window.console.log("替换(R) menu clicked!")}},{title:"转到(G)...",shortcut:"Ctrl+G",enabled:!0,handler:function(){window.console.log("转到(G) menu clicked!"),$dlgGoto.show()}},{title:"hr",shortcut:"",enabled:!0,handler:null},{title:"全选(A)",shortcut:"Ctrl+A",enabled:!0,handler:function(){window.console.log("替换(R) menu clicked!")}},{title:"时间/日期(D)",shortcut:"F5",enabled:!0,handler:function(){window.console.log("时间/日期(D) menu clicked!")}}],width:"218px",left:"52px"},{title:"格式(O)",menuItems:[{title:"自动换行(W)",shortcut:"",enabled:!0,handler:function(){window.console.log("自动换行(W) menu clicked!")}},{title:"字体(F)...",shortcut:"",enabled:!0,handler:function(){$dlgFont.show({family:np.fontFamily,style:np.fontStyle,size:np.fontSize,okHandler:np.fontHandler})}}],width:"156px",left:"106px"},{title:"查看(V)",menuItems:[{title:"状态栏(S)",shortcut:"",enabled:!0,handler:function(){window.console.log("显示状态栏")}}],width:"138px",left:"162px"},{title:"帮助(H)",menuItems:[{title:"查看帮助(H)",shortcut:"",enabled:!0,handler:function(){window.open("https://cn.bing.com/search?q=获取有关+windows+10+中的记事本的帮助","_blank")}},{title:"关于记事本(A)",shortcut:"",enabled:!0,handler:function(){$dlgAbout.show()}}],width:"166px",left:"216px"}];var $menubar=function(){var c,r=$('<div class="notepad-menubar"></div>'),u=[],f=-1;return{show:function(t){c=t,function(){for(var t=$('<ul class="menu-title"></ul>'),n=0;n<c.length;n++){var e=$('<li class="title"></li>');e.html(c[n].title),e.attr("data-id",n),t.append(e),e.click(function(t){var n=Number(this.dataset.id);f=-1===f?(u[n].css({display:"inline-block"}),n):f!==n?(u[f].css({display:"none"}),u[n].css({display:"inline-block"}),n):(u[f].css({display:"none"}),-1),t.stopPropagation()}),e.hover(function(){if(-1!==f){var t=Number(this.dataset.id);u[f].css({display:"none"}),u[t].css({display:"inline-block"}),f=t}})}for(r.append(t),n=0;n<c.length;n++){for(var l=$('<ul class="menus"></ul>'),i=c[n].menuItems,o=0;o<i.length;o++)if("hr"!==i[o].title){var s=$('<li class="menu-item"></li>');if(s.html(i[o].title),s.attr("data-x",n),s.attr("data-y",o),""!==i[o].shortcut){var a=$('<span class="shortcut"></span>');a.html(i[o].shortcut),s.append(a)}i[o].enabled||s.addClass("disabled"),l.append(s),s.click(function(t){if(t.stopPropagation(),!$(this).hasClass("disabled")){var n=this.dataset.x,e=this.dataset.y;u[n].css({display:"none"}),f=-1,c[n].menuItems[e].handler()}})}else{var d=$('<li class="menu-hr"></li>');l.append(d)}l.css({width:c[n].width,left:c[n].left,display:"none"}),r.append(l),u.push(l)}$("body").append(r)}()},hideMenu:function(){-1!==f&&(u[f].css({display:"none"}),f=-1)}}}(),$editor=function(){var n=$('<div class="notepad-editor"><textarea spellcheck="false" auto-size="none"></textarea></div>'),e=n.find("textarea");return{show:function(t){$("body").append(n),e.trigger("focus")},setFont:function(t){e.css({"font-family":t.family,"font-size":t.size+"pt"}),"斜体"!==t.style?"粗体"!==t.style?"粗偏斜体"!==t.style||e.css({"font-weight":"bold","font-style":"italic"}):e.css({"font-weight":"bold"}):e.css({"font-style":"italic"})}}}(),$dlgFont=function(){var n=$('<div class="notepad-dlg-mask notepad-dlg-font"><div class="dialogbox notepad-dlgbox"><div class="notepad-dlg-titlebar"><p class="title">字体</p><span class="close-btn" title="关闭">✖</span></div><div class="main notepad-dlg-main"><div class="font-family"><p>字体(F):</p></div><div class="font-style"><p>字形(Y):</p></div><div class="font-size"><p>大小(S):</p></div><fieldset class="sample"><legend>示例</legend><p class="sample-txt">AaBbYyZz</p></fieldset><div class="script"><label>脚本(R):<br><select><option value="西欧语言">西欧语言</option><option value="中文 GB2312">中文 GB2312</option></select></label></div><input class="btn-ok btn" type="button" value="确定"><input class="btn-cancel btn" type="button" value="取消"></div></div></div>'),e=n.find(".btn-ok"),l=n.find(".close-btn"),i=n.find(".btn-cancel"),t=n.find(".sample-txt"),o=n.find(".notepad-dlg-titlebar"),s=["Agency FB","Algerian","Arial","Arial Rounded MT","Axure Handwriting","Bahnschrift","Baskerville Old Face","Bauhaus 93","Bell MT","Berlin Sans FB","Bernard MT","BlackAdder ITC"],a=["常规","斜体","粗体","粗偏斜体"],d=["8","9","10","11","12","14","16","18","20","22","24","26","28","36","48","72"],c={family:"Arial",style:"常规",size:"16",okHandler:null};function r(){t.css({"font-family":c.family,"font-size":c.size+"pt"}),"斜体"!==c.style?"粗体"!==c.style?"粗偏斜体"!==c.style||t.css({"font-weight":"bold","font-style":"italic"}):t.css({"font-weight":"bold"}):t.css({"font-style":"italic"})}function u(){n.remove()}return{show:function(t){$.extend(c,t),$("body").append(n),(new List).show({container:".notepad-dlg-font .font-family",width:"176px",list:s,select:s.indexOf(c.family),isFont:!0,selectHandler:function(t){c.family=s[t],r()}}),(new List).show({container:".notepad-dlg-font .font-style",width:"132px",list:a,select:a.indexOf(c.style),isFontStyle:!0,selectHandler:function(t){c.style=a[t],r()}}),(new List).show({container:".notepad-dlg-font .font-size",width:"64px",list:d,select:d.indexOf(c.size),selectHandler:function(t){c.size=d[t],r()}}),r(),n.find(".dialogbox").draggable({handle:o}),l.click(u),i.click(u),e.click(function(){c.okHandler({family:c.family,style:c.style,size:c.size}),u()}),n.click(function(t){t.stopPropagation()})}}}();function List(){var i,e=$('<div class="notepad-com-list"><input class="editor" type="text"><br><ul class="list"></ul></div>'),l=e.find(".editor"),o=e.find(".list"),s={container:"",list:[],select:0,width:"200px",isFont:!1,isFontStyle:!1,selectHandler:null};function n(){var t,n=$(s.container).find(".notepad-com-list");0!==n.length&&n.remove(),$(s.container).append(e),e.css({width:s.width}),function(){var t,n,e,l=0;if(s.isFont)for(l=0;l<s.list.length;l++)(t=$('<li class="item"></li>')).css({"font-family":s.list[l]}),o.append(t.html(s.list[l]));else if(s.isFontStyle)for(l=0;l<s.list.length;l++)t=$('<li class="item"></li>'),n=t,"斜体"!==(e=s.list[l])?"粗体"!==e?"粗偏斜体"!==e||n.css({"font-weight":"bold","font-style":"italic"}):n.css({"font-weight":"bold"}):n.css({"font-style":"italic"}),o.append(t.html(s.list[l]));else for(l=0;l<s.list.length;l++)t=$('<li class="item"></li>'),o.append(t.html(s.list[l]));i=o.find(".item")}(),t=s.select,$(i[t]).addClass("selected"),l.val(s.list[t]),l.select()}this.show=function(t){$.extend(s,t),n(),o.click(function(t){$(i[s.select]).removeClass("selected"),s.select=s.list.indexOf($(t.target).html()),$(i[s.select]).addClass("selected"),l.val(s.list[s.select]),l.select(),s.selectHandler(s.select)})}}var $dlgAbout=function(){var t=$('<div class="notepad-dlg-mask notepad-dlg-about"><div class="dialogbox notepad-dlgbox"><div class="notepad-dlg-titlebar"><p class="title">关于“记事本”</p><span class="close-btn" title="关闭">✖</span></div><div class="main notepad-dlg-main"><h1 class="slogan">JSNotepad</h1><hr><img class="app-logo" src="../../images/notepad-icon-32.png" alt="JSNotepad"><div class="info"><p>作者：王亚红</p><p>QQ：2976716563</p><p>仓库地址：<a href="https://github.com/wangyahong423/spa-jsnotepad/" target="_blank">https://github.com/wangyahong423/spa-jsnotepad/</a></p></div><input class="btn-ok btn" type="button" value="确定" autofocus></div></div></div>'),n=t.find(".btn-ok"),e=t.find(".close-btn"),l=t.find(".notepad-dlg-titlebar");function i(){t.remove()}return{show:function(){$("body").append(t),t.find(".dialogbox").draggable({handle:l}),n.focus(),n.click(i),e.click(i),t.click(function(t){n.focus(),t.stopPropagation()})}}}(),$dlgGoto=function(){$dlg=$('<div class="notepad-dlg-goto"><div class="dialogbox"><div class="titlebar"><p class="title">转到指定行</p><span class="close-btn">✖</span></div><div class="main"><label>行号(L)：</label><br><input class="txt-line-num" type="text" autofocus><br><input class="btn-goto" type="button" value="转到"><input class="btn-cancel" type="button" value="取消"></div></div></div>'),cfg={container:"body",onClick:null};var n=$dlg.find(".close-btn"),e=$dlg.find(".btn-cancel"),l=$dlg.find(".btn-goto");function i(){$dlg.remove()}return{show:function(t){$(cfg.container).append($dlg),$.extend(cfg,t),$dlg.click(cfg.onClick),n.click(i),e.click(i),l.click(i)}}}();